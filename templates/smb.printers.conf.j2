[global]
    workgroup = {{ domain_member_workgroup | upper }}
    realm = {{ domain_member_realm | upper }}
    security = ADS

    log file = /var/log/samba/smbd.log

    idmap config * : backend = tdb        
    idmap config *:range = 50000-1000000
	
    template homedir = /home/%U
    template shell = /bin/bash
    winbind use default domain = true
    winbind offline logon = false
    winbind nss info = rfc2307
    winbind enum users = yes
    winbind enum groups = yes

    client signing = auto
    kerberos method = secrets and keytab
    client use spnego = yes

    preferred master = no
    domain master = no
    local master = no
#    winbind refresh tickets = yes
#    allow trusted domains = yes
#    encrypt passwords = yes

    vfs objects = acl_xattr
    map acl inherit = Yes
    store dos attributes = Yes

    # Interfaces que o samba vai responder
    #bind interfaces only = True
    #interfaces  = {{ domain_member_interfaces | default('enp0s8 lo') }}

    # Conexão com o servidor de impressão CUPS
    printcap name = cups
    printing = CUPS
    cups server = {{ domain_member_cups_server }}
    load printers = no

    # Melhora a performance das impressões
    # https://wiki.samba.org/index.php/Setting_up_Samba_as_a_Print_Server

    rpcd_spoolss:idle_seconds=300
    rpcd_spoolss:num_workers = 10

[printers]
    comment = All Printers
    browseable = no
    printable = True
    guest ok = no
    read only = yes
    path = /var/spool/samba/

{%for printer in domain_member_printers %}
[{{printer.name}}] 
    path = /var/spool/samba/ 
    browseable = yes 
    printable = yes 
    printer name = {{printer.name}}
{% endfor %}

{{ domain_member_smb_extra | default(' ') }}
